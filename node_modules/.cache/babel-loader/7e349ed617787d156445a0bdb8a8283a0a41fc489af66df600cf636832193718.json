{"ast":null,"code":"var _jsxFileName = \"R:\\\\React\\\\hello-app\\\\Tatvsoft\\\\src\\\\context\\\\auth.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useContext, useState } from \"react\";\nimport { useEffect } from \"react\";\nimport { createContext } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport shared from \"../utils/shared\";\nimport { RoutePaths } from \"../utils/enum\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst intialUserValue = {\n  id: 0,\n  email: \"\",\n  firstName: \"\",\n  lastName: \"\",\n  roleId: \"\",\n  role: \"\",\n  password: \"\"\n};\nconst initialState = {\n  setUser: () => {},\n  user: intialUserValue,\n  signOut: () => {},\n  appInitialize: false\n};\nexport const AuthContext = /*#__PURE__*/createContext(initialState);\nexport const AuthWrapper = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [appInitialize, setAppInitialize] = useState(false);\n  const [user, _setUser] = useState(intialUserValue);\n  const navigate = useNavigate();\n  const {\n    pathname\n  } = useLocation();\n  const setUser = user => {\n    console.log(\"abc@wayne2.com\", user);\n    localStorage.setItem(shared.LocalStorageKeys.USER, JSON.stringify(user));\n    _setUser(user);\n  };\n  useEffect(() => {\n    const str = JSON.parse(localStorage.getItem(shared.LocalStorageKeys.USER)) || intialUserValue;\n    if (str.id) {\n      _setUser(str);\n    }\n    if (!str.id) {\n      navigate('/login');\n    }\n  }, []);\n  const signOut = () => {\n    localStorage.removeItem(shared.LocalStorageKeys.USER);\n    _setUser(intialUserValue);\n    navigate(\"/login\");\n  };\n  useEffect(() => {\n    if (pathname === RoutePaths.Login && user.id) {\n      navigate(RoutePaths.ProductList);\n    }\n    if (!user.id) {\n      return;\n    }\n    const access = shared.hasAccess(pathname, user);\n    if (!access) {\n      toast.warning(\"Sorry,you are not authorized to access this page\");\n      navigate(\"/productList\");\n      return;\n    }\n    setAppInitialize(true);\n  }, [pathname, user]);\n  let value = {\n    user,\n    setUser,\n    signOut,\n    appInitialize\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 12\n  }, this);\n};\n_s(AuthWrapper, \"1uldX/+4u9IrXMzBVtlQv9gfuCM=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = AuthWrapper;\nexport const useAuthContext = () => {\n  _s2();\n  return useContext(AuthContext);\n};\n_s2(useAuthContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthWrapper\");","map":{"version":3,"names":["useContext","useState","useEffect","createContext","useLocation","useNavigate","toast","shared","RoutePaths","jsxDEV","_jsxDEV","intialUserValue","id","email","firstName","lastName","roleId","role","password","initialState","setUser","user","signOut","appInitialize","AuthContext","AuthWrapper","_ref","_s","children","setAppInitialize","_setUser","navigate","pathname","console","log","localStorage","setItem","LocalStorageKeys","USER","JSON","stringify","str","parse","getItem","removeItem","Login","ProductList","access","hasAccess","warning","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuthContext","_s2","$RefreshReg$"],"sources":["R:/React/hello-app/Tatvsoft/src/context/auth.jsx"],"sourcesContent":["import { useContext, useState } from \"react\";\r\nimport { useEffect } from \"react\";\r\nimport { createContext } from \"react\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\nimport shared from \"../utils/shared\";\r\nimport { RoutePaths } from \"../utils/enum\";\r\n\r\nconst intialUserValue={\r\n    id:0,\r\n    email:\"\",\r\n    firstName:\"\",\r\n    lastName:\"\",\r\n    roleId:\"\",\r\n    role:\"\",\r\n    password:\"\",\r\n};\r\nconst initialState={\r\n    setUser:()=>{},\r\n   user:intialUserValue,\r\n    signOut:()=>{},\r\n    appInitialize:false,\r\n}\r\nexport const AuthContext=createContext(initialState);\r\n\r\nexport const AuthWrapper=({children})=>{\r\n    const [appInitialize,setAppInitialize]=useState(false);\r\n    const[user,_setUser]=useState(intialUserValue);\r\n    const navigate=useNavigate();\r\n    const {pathname}=useLocation();\r\n\r\n    const setUser=(user)=>{\r\n        console.log(\"abc@wayne2.com\",user);\r\n        localStorage.setItem(shared.LocalStorageKeys.USER,JSON.stringify(user));\r\n        _setUser(user)\r\n    };\r\n    useEffect(()=>{\r\n        const str=JSON.parse(localStorage.getItem(shared.LocalStorageKeys.USER))|| intialUserValue;\r\n        if(str.id){\r\n            _setUser(str);\r\n        }\r\n        if(!str.id){\r\n            navigate('/login');\r\n        }\r\n    },[]);\r\n    const signOut=()=>{\r\n        \r\n        localStorage.removeItem(shared.LocalStorageKeys.USER);\r\n        _setUser(intialUserValue);\r\n        navigate(\"/login\");\r\n    };\r\n\r\n    useEffect(()=>{\r\n        if(pathname===RoutePaths.Login && user.id){\r\n            navigate(RoutePaths.ProductList);\r\n        }\r\n        if(!user.id){\r\n            return;\r\n        }\r\n        const access=shared.hasAccess(pathname,user);\r\n        if(!access){\r\n            toast.warning(\"Sorry,you are not authorized to access this page\");\r\n            navigate(\"/productList\");\r\n            return;\r\n        }\r\n        setAppInitialize(true);\r\n    },[pathname,user]);\r\n\r\n    let value={\r\n        user,\r\n        setUser,\r\n        signOut,\r\n        appInitialize,\r\n    };\r\n\r\n    return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n\r\nexport const useAuthContext=()=>{\r\n    return useContext(AuthContext);\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}